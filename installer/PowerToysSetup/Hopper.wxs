<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi"
     xmlns:util="http://schemas.microsoft.com/wix/UtilExtension" >
  <?include $(sys.CURRENTDIR)\Common.wxi?>
  <?define HopperAssetsFiles=?>
  <?define HopperAssetsFilesPath=$(var.BinDir)WinUI3Apps\Assets\Hopper\?>
  <Fragment>
    <DirectoryRef Id="WinUI3AppsAssetsFolder">
      <Directory Id="HopperAssetsFolder" Name="Hopper" />
    </DirectoryRef>
    <DirectoryRef Id="HopperAssetsFolder" FileSource="$(var.HopperAssetsFilesPath)">
    <!-- Generated by generateFileComponents.ps1 -->
    <!--HopperAssetsFiles_Component_Def-->
      <!-- !Warning! Make sure to change Component Guid if you update something here -->
      <Component Id="Module_Hopper" Guid="5E785611-FE77-4DC3-89AE-6A055F2ED053" Win64="yes">
		  <RegistryKey Root="$(var.RegistryScope)" Key="Software\Classes\CLSID\{5E785611-FE77-4DC3-89AE-6A055F2ED053}">
          <RegistryValue Type="string" Value="Hopper Shell Extension" />
          <RegistryValue Type="string" Name="ContextMenuOptIn" Value="" />
          <RegistryValue Type="string" Key="InprocServer32" Value="[WinUI3AppsInstallFolder]PowerToys.HopperExt.dll" />
          <RegistryValue Type="string" Key="InprocServer32" Name="ThreadingModel" Value="Apartment" />
        </RegistryKey>
        <RegistryKey Root="$(var.RegistryScope)" Key="SOFTWARE\Classes\AllFileSystemObjects\ShellEx\ContextMenuHandlers\HopperExt">
          <RegistryValue Type="string" Value="{5E785611-FE77-4DC3-89AE-6A055F2ED053}"/>
        </RegistryKey>
        <RegistryKey Root="$(var.RegistryScope)" Key="SOFTWARE\Classes\Directory\background\ShellEx\ContextMenuHandlers\HopperExt">
          <RegistryValue Type="string" Value="{5E785611-FE77-4DC3-89AE-6A055F2ED053}"/>
        </RegistryKey>
      </Component>
    </DirectoryRef>
    <ComponentGroup Id="HopperComponentGroup">
      <Component Id="RemoveHopperFolder" Guid="AFA04A84-D3D6-418D-A679-33A1292E4A19" Directory="HopperAssetsFolder" >
        <RegistryKey Root="$(var.RegistryScope)" Key="Software\Classes\powertoys\components">
          <RegistryValue Type="string" Name="RemoveHopperFolder" Value="" KeyPath="yes"/>
        </RegistryKey>
        <RemoveFolder Id="RemoveFolderHopperAssetsFolder" Directory="HopperAssetsFolder" On="uninstall"/>
      </Component>
      <ComponentRef Id="Module_Hopper" />
    </ComponentGroup>
  </Fragment>
</Wix>